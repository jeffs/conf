if [[ ! -v JEFF_LOGIN_DONE ]]; then
    source ~/conf/etc/zprofile
    export LS_COLORS='di=01;36'
    export READNULLCMD=$PAGER
fi

## HISTORY

HISTFILE=~/.zsh_history
HISTSIZE=50000
SAVEHIST=50000
setopt append_history
setopt hist_ignore_dups
setopt hist_ignore_space

## COMPLETION

autoload -Uz compinit && compinit

## PROMPT

PROMPT=$'\n%F{cyan}%~%f\n%# '

## OPTIONS

setopt rmstarsilent	# Don't confirm rm *.

unsetopt autocd
unsetopt auto_pushd
unsetopt correct_all
unsetopt hist_verify
unsetopt share_history

zstyle ':completion:*' matcher-list ''

# Complete filenames after =, as in --someflag=.  Copied from:
# https://unix.stackexchange.com/a/599449/49952
autoload +X -U _default
functions[_default]="setopt local_options magic_equal_subst; $functions[_default]"

if [[ "$TERM_PROGRAM" == vscode ]]; then
    # Prefix matches with `file:lineno:` so I can click to open.
    alias rg='rg --no-heading'
fi

## FUNCTIONS

# Strip comment leaders from copy/pasted sample code.
function $ { "$@" }
function // { "$@" }

function c { cd "$@" && ls; }
function cg { c $(git rev-parse --show-toplevel); }
function mc { mkdir -p $1 && c $1; }

## PROFILES
#
# Extensions and overrides for specific projects.  Checking out different
# profiles on different laptops allows customization for home, work, etc.

for conf_module in ~/git/conf-*(N); do
    if [ -r $conf_module/etc/zshrc ]; then
        source $conf_module/etc/zshrc
    fi
done
